const imageUpload=document.getElementById("imageUpload"),imagePreview=document.getElementById("avatar__display");try{imageUpload.addEventListener("change",(function(){const e=this.files[0];if(e){const a=new FileReader;a.onload=function(e){const a=e.target.result;avatar__display.innerHTML=`<img src="${a}" alt="Uploaded Image" style="max-width: 100%;">`},a.readAsDataURL(e)}}))}catch(e){console.log(e)}function getCookie(e){const a=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return a?a.pop():""}const userCookieValue=JSON.parse(getCookie("user")),imageField=document.getElementById("img-account-profile"),usernameField=document.getElementById("inputUsername"),emailField=document.getElementById("inputEmailAddress"),passwordField=document.getElementById("inputPassWord");try{userCookieValue?(imageField.src=userCookieValue.profilePictureUrl,usernameField.value=userCookieValue.username,emailField.value=userCookieValue.email,passwordField.value=userCookieValue.password):console.log("Không tìm thấy cookie")}catch(e){console.log(e)}try{document.getElementById("save__changes").addEventListener("click",(function(){const e=imageField.src,a=usernameField.value,t=emailField.value,s=passwordField.value,i=new XMLHttpRequest;i.open("POST","/updateUserInfo",!0),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE)if(200===i.status){const e=JSON.parse(i.responseText);imageField.src=e.imageData,usernameField.value=e.username,emailField.value=e.email,passwordField.value="",alert(e.message)}else console.error("Failed to update user info. Status:",i.status),alert("Đã xảy ra lỗi khi cập nhật thông tin người dùng.")};const n=JSON.stringify({imageData:e,username:a,email:t,password:s});i.send(n)}))}catch(e){}